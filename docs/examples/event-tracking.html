<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="robots" content="noindex">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<title>Iframe - Barney</title>
	<link rel="stylesheet" href="../assets/main.css">
</head>
<body>

	<div id="wrap">
		
		<h1>Event tracking</h1>

		<div class="lorem small"></div>

		<div id="viewer">
			<iframe src="https://viewer.barney-technologies.com/ab67aa4a88bcfef81dee0202?autorotate" allowfullscreen frameborder="0"></iframe>
		</div>

		<p>Interact with the viewer and see below all the event triggered that can be listened to via <code>window.addEventListener('message', event => {})</code>.</p>

		<div id="logs"></div>

		<div class="lorem large"></div>

		<style>

			/* -------------------------
				VIEWER 16:9
			------------------------- */

			#viewer {
				position: relative;
			}
			#viewer::before {
				content: '';
				display: block;
				padding-bottom: 56.25%;
			}
			#viewer iframe {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
			}

			/* -------------------------
				LOGS
			------------------------- */

			#logs {
				height: 100px;
				margin: 20px 0;
				padding: 10px;

				overflow: auto;
				white-space: pre;

				color: #fff;
				font-size: 12px;
				line-height: 1.6;
				font-family: monospace;

				background-color: #222;
				border-radius: 10px;
			}

			#logs p { margin: 0; }
			#logs p + p { opacity: 0.8; }
			#logs p + p + p { opacity: 0.4; }
			#logs p + p + p + p { opacity: 0.2; }

		</style>

		<script>

			// Way to capture events from the viewer
			window.addEventListener('message', event => {
				if (event.data.type != 'barney.viewer.trackingEvent') return

				// event.data contains:
				//  - category (e.g., 'interaction')
				//  - action (e.g., 'zoom' or 'rotate')

				log(JSON.stringify(event.data))
			})
			
			const logs = document.getElementById('logs')
			function log(str) {
				const line = document.createElement('p')
				line.innerHTML = (new Date()).toISOString().substr(11, 12) + ' â†’ ' + str
				logs.prepend(line)
			}
		</script>

	</div>

</body>
</html>